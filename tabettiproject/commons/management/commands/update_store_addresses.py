from django.core.management.base import BaseCommand
from django.db import transaction
from commons.models import Store  # ← アプリ名修正
import random


ADDRESSES = [
    "東京都千代田区千代田1-1",
    "東京都千代田区丸の内1丁目1-1",
    "東京都千代田区大手町1丁目7-1",
    "東京都千代田区霞が関1丁目1-1",
    "東京都中央区銀座4丁目1-2",
    "東京都中央区日本橋1丁目1-1",
    "東京都港区芝公園4丁目2-8",
    "東京都港区六本木6丁目10-1",
    "東京都港区赤坂5丁目3-1",
    "東京都新宿区西新宿2丁目8-1",
    "東京都新宿区歌舞伎町1丁目1-1",
    "東京都新宿区新宿3丁目38-1",
    "東京都渋谷区神南1丁目19-11",
    "東京都渋谷区渋谷2丁目21-1",
    "東京都渋谷区恵比寿4丁目20-3",
    "東京都豊島区南池袋1丁目28-1",
    "東京都豊島区西池袋1丁目1-30",
    "東京都文京区後楽1丁目3-61",
    "東京都台東区上野公園7-20",
    "東京都墨田区押上1丁目1-2",
    "東京都江東区青海1丁目1-10",
    "東京都品川区東品川2丁目3-2",
    "東京都目黒区上目黒2丁目1-1",
    "東京都大田区羽田空港3丁目3-2",
    "東京都世田谷区太子堂4丁目1-1",
    "東京都中野区中野5丁目52-15",
    "東京都杉並区高円寺南4丁目26-16",
    "東京都練馬区光が丘2丁目4-1",
    "東京都板橋区常盤台1丁目1-1",
    "東京都北区王子1丁目9-1",
    "東京都荒川区西日暮里2丁目19-1",
    "東京都足立区千住旭町42-1",
    "東京都葛飾区亀有3丁目25-1",
    "東京都江戸川区臨海町6丁目3-1",

    "神奈川県横浜市西区みなとみらい2丁目3-5",
    "神奈川県横浜市中区山下町10",
    "神奈川県横浜市港北区新横浜2丁目3-1",
    "神奈川県川崎市川崎区駅前本町26-1",
    "神奈川県川崎市幸区堀川町72-1",
    "神奈川県横須賀市本町2丁目1",
    "神奈川県鎌倉市小町1丁目1-1",
    "神奈川県藤沢市藤沢75",
    "神奈川県小田原市城内6-1",
    "神奈川県厚木市中町2丁目6-10",

    "千葉県千葉市中央区新千葉1丁目1-1",
    "千葉県千葉市美浜区ひび野2丁目110",
    "千葉県船橋市浜町2丁目1-1",
    "千葉県柏市末広町1-1",
    "千葉県松戸市松戸1181",
    "千葉県浦安市舞浜1-1",
    "千葉県成田市古込1-1",
    "千葉県市川市市川1丁目1-1",
    "千葉県木更津市富士見1丁目1-1",
    "千葉県佐倉市城内町117",

    "埼玉県さいたま市大宮区錦町630",
    "埼玉県さいたま市浦和区高砂3丁目15-1",
    "埼玉県川口市栄町3丁目1-1",
    "埼玉県川越市新富町1丁目22",
    "埼玉県所沢市日吉町12-1",
    "埼玉県越谷市南越谷1丁目11-4",
    "埼玉県草加市高砂2丁目7-1",
    "埼玉県熊谷市筑波2丁目115",
    "埼玉県春日部市中央1丁目1-1",
    "埼玉県深谷市西島町1丁目1-1",

    "愛知県名古屋市中区三の丸1丁目1-1",
    "愛知県名古屋市中村区名駅1丁目1-4",
    "愛知県名古屋市東区東桜1丁目1-1",
    "愛知県名古屋市千種区今池1丁目1-1",
    "愛知県名古屋市昭和区鶴舞1丁目1-1",
    "愛知県豊田市西町3丁目60",
    "愛知県岡崎市康生通西1丁目1",
    "愛知県一宮市栄3丁目1-2",
    "愛知県春日井市鳥居松町5丁目44",
    "愛知県刈谷市若松町1丁目1",

    "大阪府大阪市北区梅田1丁目1-3",
    "大阪府大阪市北区中之島1丁目3-20",
    "大阪府大阪市中央区難波5丁目1-60",
    "大阪府大阪市中央区本町1丁目8-12",
    "大阪府大阪市天王寺区悲田院町10-45",
    "大阪府大阪市浪速区恵美須東1丁目18-6",
    "大阪府堺市堺区戎島町3丁22-1",
    "大阪府東大阪市荒本北1丁目1-1",
    "大阪府豊中市新千里東町1丁目1-3",
    "大阪府吹田市千里万博公園1-1",

    "兵庫県神戸市中央区港島中町6丁目9-1",
    "兵庫県神戸市中央区加納町6丁目5-1",
    "兵庫県神戸市灘区六甲台町1-1",
    "兵庫県姫路市本町68",
    "兵庫県西宮市高松町14-2",
    "兵庫県尼崎市神田中通1丁目4",
    "兵庫県明石市本町1丁目1-1",
    "兵庫県宝塚市栄町2丁目1-1",
    "兵庫県伊丹市西台1丁目1-1",
    "兵庫県三田市駅前町2-1",

    "京都府京都市東山区清水1丁目294",
    "京都府京都市下京区東塩小路町721-1",
    "京都府京都市中京区寺町通御池上ル",
    "京都府京都市左京区吉田本町",
    "京都府京都市右京区嵯峨天龍寺芒ノ馬場町",
    "京都府宇治市宇治蓮華116",
    "京都府亀岡市追分町谷筋1",
    "京都府長岡京市開田4丁目1-1",
    "京都府福知山市駅前町439",
    "京都府舞鶴市字北吸1039-2",

    "福岡県福岡市博多区博多駅中央街1-1",
    "福岡県福岡市中央区天神1丁目11-1",
    "福岡県北九州市小倉北区浅野1丁目1-1",
    "福岡県久留米市東町316-2",
    "福岡県飯塚市新立岩5-5",
    "福岡県大牟田市不知火町1丁目1",
    "福岡県春日市春日原北町3丁目1",
    "福岡県筑紫野市石崎1丁目1-1",
    "福岡県糸島市前原中央1丁目1-1",
    "福岡県宗像市東郷1丁目1-1",

    "北海道札幌市中央区北5条西2丁目5",
    "北海道札幌市北区北8条西3丁目28",
    "北海道函館市若松町12-13",
    "北海道旭川市宮下通7丁目2-5",
    "北海道帯広市西2条南12丁目",
    "北海道釧路市北大通10丁目",
    "北海道苫小牧市表町5丁目11-5",
    "北海道小樽市港町5-3",
    "北海道北見市北2条西1丁目",
    "北海道室蘭市中島町1丁目1-1",
]

class Command(BaseCommand):
    help = "Store.address をテスト用住所で一括更新（店舗数が多くても循環対応）"

    def handle(self, *args, **options):
        stores = list(Store.objects.all())
        total = len(stores)

        if total == 0:
            self.stdout.write(self.style.WARNING("Store が存在しません"))
            return

        random.shuffle(ADDRESSES)
        address_count = len(ADDRESSES)

        with transaction.atomic():
            for i, store in enumerate(stores):
                store.address = ADDRESSES[i % address_count]
                store.save(update_fields=["address"])

        self.stdout.write(
            self.style.SUCCESS(
                f"{total} 件の Store.address を更新しました（住所 {address_count} 件を循環使用）"
            )
        )
