{% extends "company_base.html" %}

{% block content %}
<style>
/* ===== Layout ===== */
.review-wrapper{
  max-width:1100px;
  margin:40px auto;
  padding:0 20px;
  font-family:sans-serif;
}

/* ===== Header ===== */
.page-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:2px solid #eee;
  margin-bottom:30px;
  padding-bottom:15px;
}
.page-header h1{
  font-size:24px;
  color:#333;
  margin:0;
  border-left:5px solid #ff9600;
  padding-left:15px;
}

/* ===== Card ===== */
.content-card{
  background:#fff;
  border:1px solid #ddd;
  border-radius:8px;
  padding:30px;
  box-shadow:0 2px 8px rgba(0,0,0,0.05);
  margin-bottom:30px;
}
.info-text{
  color:#666;
  margin-bottom:20px;
  font-size:15px;
}

/* ===== Table ===== */
.review-table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
.review-table th{
  text-align:left;
  background:#fafafa;
  border-bottom:2px solid #ddd;
  padding:12px 10px;
  white-space:nowrap;
}
.review-table td{
  padding:12px 10px;
  border-bottom:1px solid #eee;
  vertical-align:middle;
}
.review-table tr:hover{
  background:#fcfcfc;
}

/* ===== Status ===== */
.status-chip{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:bold;
}
.status-pending{
  background:#fff3e0;
  color:#e68700;
}

/* ===== Buttons ===== */
.btn{
  display:inline-block;
  padding:8px 14px;
  border-radius:5px;
  font-weight:bold;
  text-decoration:none;
  font-size:13px;
}
.btn-detail{
  background:#ff9600;
  color:#fff;
}
.btn-detail:hover{
  background:#e68700;
}
.btn-back{
  background:#fff;
  color:#666;
  border:1px solid #ccc;
}
.btn-back:hover{
  background:#f8f9fa;
  border-color:#999;
}

/* ===== Footer ===== */
.footer-nav{
  margin-top:20px;
}
.empty{
  text-align:center;
  color:#777;
  padding:20px;
}

/* ページネーション */
.sa-pager {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 14px;
    margin-top: 25px;
    padding-top: 20px;
    border-top: 1px solid #eee;
}

.sa-link {
    color: #1e73c9;
    text-decoration: none;
    font-size: 13px;
}

.sa-link:hover {
    text-decoration: underline;
}

.sa-link-disabled {
    color: #aaa;
    pointer-events: none;
    text-decoration: none;
    font-size: 13px;
}

.sa-pageinfo {
    font-size: 12px;
    color: #666;
}
</style>

<div class="review-wrapper">

  <!-- Header -->
  <header class="page-header">
    <h1>店舗アカウント審査 運用</h1>
  </header>

  <!-- Content -->
  <div class="content-card">
    <p class="info-text">
      店舗からのアカウント申請の一覧です。申請内容を確認し、詳細画面から承認または却下してください。
    </p>

    {% if requests %}
      <table class="review-table">
        <thead>
          <tr>
            <th>申請日時</th>
            <th>店舗名</th>
            <th>申請者</th>
            <th>ステータス</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for r in requests %}
            <tr>
              <td>{{ r.requested_at|date:"Y-m-d H:i" }}</td>
              <td>
                {{ r.store_name }}
                {% if r.branch_name %}
                  {{ r.branch_name }}
                {% endif %}
              </td>
              <td>{{ r.applicant_name }}</td>
              <td>
                <span class="status-chip status-pending">
                  {{ r.request_status.status }}
                </span>
              </td>
              <td>
                <a
                  class="btn btn-detail"
                  href="{% url 'accounts:company_store_review_detail' r.id %}">
                  詳細
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- ページネーション -->
      {% if requests and requests.has_other_pages %}
      <div class="sa-pager">
        {% if requests.has_previous %}
        <a class="sa-link" href="?page={{ requests.previous_page_number }}">前へ</a>
        {% else %}
        <span class="sa-link sa-link-disabled">前へ</span>
        {% endif %}

        <span class="sa-pageinfo">Page {{ requests.number }} / {{ requests.paginator.num_pages }}</span>

        {% if requests.has_next %}
        <a class="sa-link" href="?page={{ requests.next_page_number }}">次へ</a>
        {% else %}
        <span class="sa-link sa-link-disabled">次へ</span>
        {% endif %}
      </div>
      {% endif %}
    {% else %}
      <div class="empty">
        現在、申請中の店舗はありません。
      </div>
    {% endif %}
  </div>

  <!-- Back -->
  <div class="footer-nav">
    <a href="{% url 'accounts:company_top' %}" class="btn btn-back">
      ← 運用トップへ戻る
    </a>
  </div>

</div>
{% endblock %}
