{% extends "store_base.html" %}

{% block title %}店舗管理基本情報変更{% endblock %}

{% block content %}

<style>
/* ここはあなたの現行CSSをほぼ維持（必要なら後で調整） */
:root{
  --bg:#f3f4f6;
  --card:#ffffff;
  --line:#d9dde3;
  --text:#222;
  --muted:#6b7280;
  --link:#1a73e8;
  --primary:#2563eb;
  --primary-bg:#eff6ff;
  --danger:#b42318;
  --danger-bg:#ffe9e7;
}
.page-wrap{max-width:1200px;margin:0 auto;padding:12px 12px 28px;color:var(--text);}
a{color:var(--link);text-decoration:none;}
a:hover{text-decoration:underline;}
.hd{display:flex;align-items:flex-end;justify-content:space-between;gap:10px;flex-wrap:wrap;margin:8px 0 12px;}
.hd .left .title{font-size:18px;font-weight:900;margin:0;}
.hd .btns{display:flex;gap:8px;flex-wrap:wrap;align-items:center;}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;border:1px solid var(--line);background:#fff;color:#111;padding:8px 12px;border-radius:8px;font-weight:900;font-size:12px;cursor:pointer;text-decoration:none;}
.btn:hover{background:#f3f4f6;text-decoration:none;}
.btn.primary{background:var(--primary);border-color:var(--primary);color:#fff;}
.btn.primary:hover{filter:brightness(.97);}
.btn.gray{background:#f8fafc;}
.notice{background:var(--danger-bg);border:1px solid #f3b6b0;color:var(--danger);border-radius:10px;padding:10px 12px;font-size:12px;font-weight:900;line-height:1.6;margin:10px 0 12px;}
.layout{display:grid;grid-template-columns:1fr 340px;gap:16px;align-items:start;}
@media (max-width:980px){.layout{grid-template-columns:1fr;}}
.card{background:var(--card);border:1px solid var(--line);border-radius:12px;overflow:hidden;}
.card + .card{margin-top:12px;}
.card-h{padding:10px 12px;border-bottom:1px solid var(--line);background:#f8fafc;font-weight:900;font-size:13px;display:flex;align-items:center;justify-content:space-between;gap:10px;}
.card-b{padding:12px;}
.grid{display:grid;grid-template-columns:200px 1fr;gap:10px 14px;align-items:center;}
@media (max-width:720px){.grid{grid-template-columns:1fr;}}
.label{font-size:12px;font-weight:900;color:#334155;}
input, select, textarea{
  width:100%;
  border:1px solid #e5e7eb;
  border-radius:8px;
  padding:9px 10px;
  font-size:13px;
  background:#fff;
  outline:none;
}
textarea{min-height:90px;resize:vertical;}
.hint{margin-top:6px;font-size:11px;color:var(--muted);font-weight:800;line-height:1.5;}
.actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;margin-top:10px;}
.sticky{position:sticky;top:14px;}
@media (max-width:980px){.sticky{position:static;}}
.side{background:var(--card);border:1px solid var(--line);border-radius:12px;overflow:hidden;}
.side-h{padding:10px 12px;border-bottom:1px solid var(--line);background:#f8fafc;font-weight:900;font-size:13px;}
.side-b{padding:12px;}
.side-kv{display:grid;grid-template-columns:90px 1fr;gap:8px 10px;align-items:center;font-size:12px;}
.side-k{color:var(--muted);font-weight:900;}
.side-v{font-weight:900;color:#111;}
.errorlist{margin:0;padding-left:18px;color:#b42318;font-size:12px;font-weight:900;}
</style>

<div class="page-wrap">

  <div class="hd">
    <div class="left">
      <div class="title">店舗基本情報変更</div>
    </div>
    <div class="btns">
      <a class="btn gray" href="{% url 'stores:store_top' %}">戻る</a>
      <button class="btn primary" type="submit" form="storeBasicForm">保存</button>
    </div>
  </div>

  <div class="notice">
    店舗情報を更新する前に内容をご確認ください。
  </div>

  <div class="layout">

    <main>
      <form id="storeBasicForm" method="post">
        {% csrf_token %}

        <!-- エラー（上にまとめて表示） -->
        {% if form.errors %}
          <div class="notice" style="background:#fff;border-color:#fecaca;color:#b42318;">
            入力内容にエラーがあります。赤字の項目を確認してください。
          </div>
        {% endif %}

        <!-- 基本情報 -->
<section class="card">
  <div class="card-h">
    <div>基本情報</div>
    <div style="font-size:11px;color:var(--muted);font-weight:900;">Store</div>
  </div>

  <div class="card-b">

    {# フォーム全体のエラー（非フィールドエラー） #}
    {% if form.non_field_errors %}
      <div style="margin-bottom:10px;padding:10px 12px;border:1px solid #fecaca;background:#fff1f2;border-radius:10px;color:#991b1b;font-weight:900;font-size:12px;">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <div class="grid">

      <div class="label">店舗名 <span class="badge-req">必須</span></div>
      <div>
        {{ form.store_name }}
        {% if form.store_name.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.store_name.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">支店名 <span class="badge-req">必須</span></div>
      <div>
        {{ form.branch_name }}
        {% if form.branch_name.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.branch_name.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">メール <span class="badge-req">必須</span></div>
      <div>
        {{ form.email }}
        {% if form.email.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.email.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">電話番号 <span class="badge-req">必須</span></div>
      <div>
        {{ form.phone_number }}
        {% if form.phone_number.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.phone_number.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">住所 <span class="badge-req">必須</span></div>
      <div>
        {{ form.address }}
        {% if form.address.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.address.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">地図 <span class="badge-opt">任意</span></div>
      <div>
        {{ form.map_location }}
        {% if form.map_location.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.map_location.errors }}
          </div>
        {% endif %}
        <div class="hint">例：Google マップURL / 座標文字列など</div>
      </div>

      <div class="label">エリア <span class="badge-req">必須</span></div>
      <div>
        {{ form.area }}
        {% if form.area.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.area.errors }}
          </div>
        {% endif %}
      </div>

    </div>
  </div>
</section>

<!-- 営業時間 -->
<section class="card">
  <div class="card-h">
    <div>営業時間</div>
    <div style="font-size:11px;color:var(--muted);font-weight:900;">open/close</div>
  </div>

  <div class="card-b">
    <div class="grid">

      <div class="label">営業時間メモ <span class="badge-opt">任意</span></div>
      <div>
        {{ form.business_hours }}
        {% if form.business_hours.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.business_hours.errors }}
          </div>
        {% endif %}
        <div class="hint">例：月〜金 11:00-15:00／土日祝 11:00-16:00</div>
      </div>

      <div class="label">営業時間1 <span class="badge-opt">任意</span></div>
      <div>
        <div class="row tight" style="align-items:center;">
          <div style="flex:1;">{{ form.open_time_1 }}</div>
          <span style="flex:0;min-width:auto;color:var(--muted);font-weight:900;">〜</span>
          <div style="flex:1;">{{ form.close_time_1 }}</div>
        </div>
        {% if form.open_time_1.errors or form.close_time_1.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.open_time_1.errors }}
            {{ form.close_time_1.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">営業時間2 <span class="badge-opt">任意</span></div>
      <div>
        <div class="row tight" style="align-items:center;">
          <div style="flex:1;">{{ form.open_time_2 }}</div>
          <span style="flex:0;min-width:auto;color:var(--muted);font-weight:900;">〜</span>
          <div style="flex:1;">{{ form.close_time_2 }}</div>
        </div>
        {% if form.open_time_2.errors or form.close_time_2.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.open_time_2.errors }}
            {{ form.close_time_2.errors }}
          </div>
        {% endif %}
      </div>

    </div>
  </div>
</section>

<!-- その他 -->
<section class="card">
  <div class="card-h">
    <div>その他</div>
    <div style="font-size:11px;color:var(--muted);font-weight:900;">settings</div>
  </div>

  <div class="card-b">
    <div class="grid">

      <div class="label">席数 <span class="badge-req">必須</span></div>
      <div>
        {{ form.seats }}
        {% if form.seats.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.seats.errors }}
          </div>
        {% endif %}
      </div>

      <div class="label">予算 <span class="badge-req">必須</span></div>
      <div>
        {{ form.budget }}
        {% if form.budget.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.budget.errors }}
          </div>
        {% endif %}
        <div class="hint">数値で入力（例：1000）</div>
      </div>

      <div class="label">シーン <span class="badge-req">必須</span></div>
      <div>
        {{ form.scene }}
        {% if form.scene.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.scene.errors }}
          </div>
        {% endif %}
        <div class="hint">Sceneマスタから選択</div>
      </div>

      <div class="label">予約可 <span class="badge-req">必須</span></div>
      <div>
        <label style="display:flex;gap:8px;align-items:center;font-weight:900;">
          {{ form.reservable }}
          <span>予約を受け付ける</span>
        </label>
        {% if form.reservable.errors %}
          <div style="margin-top:6px;color:#b42318;font-size:11px;font-weight:900;">
            {{ form.reservable.errors }}
          </div>
        {% endif %}
        <div class="hint">チェックあり：予約可 / なし：予約不可</div>
      </div>

    </div>

    <div class="actions">
      <a class="btn gray" href="{% url 'stores:store_top' %}">戻る</a>
      <button class="btn primary" type="submit">保存する</button>
    </div>

  </div>
</section>

</form>
</main>

<!-- 右カラム -->
<aside class="sticky">
  <div class="side">
    <div class="side-h">店舗サマリー</div>
    <div class="side-b">
      <div class="side-kv">
        <div class="side-k">店舗名</div>
        <div class="side-v">{{ store.store_name|default:"-" }}</div>

        <div class="side-k">支店</div>
        <div class="side-v">{{ store.branch_name|default:"-" }}</div>

        <div class="side-k">電話</div>
        <div class="side-v">{{ store.phone_number|default:"-" }}</div>

        <div class="side-k">席数</div>
        <div class="side-v">{{ store.seats|default:"-" }}</div>
      </div>

      <div class="hint" style="margin-top:10px;">
        ※ ここは管理画面の統一レイアウト用の枠です
      </div>
    </div>
  </div>
</aside>


  </div>
</div>

{% endblock %}
