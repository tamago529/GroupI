{% extends "customer_base.html" %}

{% block title %}検索結果一覧 - タベッチ{% endblock %}

{% block content %}

<style>
.search-result-container {
    display: flex;
    max-width: 90vw;
    padding: 0 24px;
    margin: 24px auto;
    gap: 24px;
    font-family: "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
    color: #222;
    background: #fff;
}

/* 左 */
.search-result-container aside {
    width: 260px;
}

.filter-box {
    background: #fff;
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    font-size: 13px;
}

.filter-title {
    font-size: 15px;
    font-weight: bold;
    margin-bottom: 12px;
}

/* 右 */
.search-result-container main {
    flex: 1;
}

.result-count-bar {
    display: flex;
    align-items: baseline;
    gap: 12px;
    margin-bottom: 16px;
}

.count-text {
    font-size: 20px;
    font-weight: bold;
    margin: 0;
}

.count-sub {
    font-size: 13px;
    color: #666;
}

/* 店舗カード */
.shop-card {
    display: flex;
    gap: 18px;
    padding: 18px;
    margin-bottom: 16px;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.08);
}

.shop-photo img {
    border-radius: 6px;
    object-fit: cover;
}

.shop-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* 店舗名 */
.shop-name {
    margin: 0;
}

/* ✅ 店舗名リンク（枠なし） */
.shop-name-btn {
    display: inline;
    font-size: 17px;
    font-weight: bold;
    color:#06c;
    text-decoration: none; /* 通常は下線なし */
}

.shop-name-btn:hover {
    text-decoration: underline; /* hoverだけ下線 */
}

.shop-name-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(255, 122, 0, 0.18);
    border-radius: 4px; /* 文字周りのフォーカスを少し丸く */
}

.rating-section {
    display: flex;
    gap: 8px;
    align-items: center;
}

.rating-num {
    font-size: 20px;
    font-weight: bold;
    color: #ff8c00;
}

.shop-meta {
    font-size: 13px;
    color: #555;
}

.budget-bar {
    margin-top: auto;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    font-size: 13px;
    color: #333;
}

/* ページネーション */
.pagination {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 32px 0;
}

.pagination a,
.pagination span {
    padding: 6px 12px;
    border-radius: 20px;
    border: 1px solid #ff7a00;
    color: #ff7a00;
    text-decoration: none;
}

.pagination .current {
    background: #ff7a00;
    color: #fff;
}
</style>

<div class="search-result-container">

    <!-- 左：検索条件 -->
    <aside>
        <div class="filter-box">
            <div class="filter-title">検索条件</div>

            <p>
                エリア：
                {% if area %}
                    {{ area }}
                {% else %}
                    指定なし
                {% endif %}
            </p>

            <p>
                キーワード：
                {% if keyword %}
                    {{ keyword }}
                {% else %}
                    指定なし
                {% endif %}
            </p>
        </div>
    </aside>

    <!-- 右：検索結果 -->
    <main>
        <div class="result-count-bar">
            <h1 class="count-text">店舗一覧</h1>
            <span class="count-sub">
                全 {{ stores.paginator.count }} 件
            </span>
        </div>

        {% for store in stores %}
        <article class="shop-card">
            <div class="shop-photo">
                <img src="https://via.placeholder.com/200x150" width="200" height="150" alt="店舗画像">
            </div>

            <div class="shop-info">
                <h2 class="shop-name">
                    <a
                      class="shop-name-btn"
                      href="{% url 'stores:customer_store_info' store.pk %}"
                    >
                      {{ stores.start_index|add:forloop.counter0 }}.
                      {{ store.store_name }}{% if store.branch_name %}（{{ store.branch_name }}）{% endif %}
                    </a>
                </h2>

                <div class="rating-section">
                    <span class="rating-num">3.5</span>
                    <span>口コミ準備中</span>
                </div>

                <div class="shop-meta">
                    {{ store.area.area_name }} /
                    {{ store.scene.scene_name }} /
                    {{ store.genre.genre_name }}
                </div>

                <!-- ✅ 予約するボタン削除 → 予算だけ表示 -->
                <div class="budget-bar">
                    <span>予算：¥{{ store.budget }}</span>
                </div>
            </div>
        </article>
        {% empty %}
            <p>店舗がありません。</p>
        {% endfor %}

        <!-- ページネーション -->
        <div class="pagination">
            {% if stores.has_previous %}
                <a href="?page={{ stores.previous_page_number }}{% if area %}&area={{ area }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}">
                    前へ
                </a>
            {% endif %}

            {% for num in stores.paginator.page_range %}
                {% if stores.number == num %}
                    <span class="current">{{ num }}</span>
                {% else %}
                    <a href="?page={{ num }}{% if area %}&area={{ area }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}">
                        {{ num }}
                    </a>
                {% endif %}
            {% endfor %}

            {% if stores.has_next %}
                <a href="?page={{ stores.next_page_number }}{% if area %}&area={{ area }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}">
                    次へ
                </a>
            {% endif %}
        </div>

    </main>

</div>
{% endblock %}
